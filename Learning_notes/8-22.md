## linux系统整体结构的划分
![Alt text](image.png)
- linux系统可以简单的划分为 **用户区** 和 **内核区**
- linux系统为何分区
  - **进程** 是操作系统的执行单元，用户的一切操作都是以 **进程** 为单元的。
    - 一个进程也可以被划分为用户区，内核区
    - 从数据、硬件、操作系统的安全性考虑，分区是必须的
    - 进程在用户区在执行时，不能访问内核区的东西（操作系统的核心在内核区）
    - 进程在内核区时，可以任意访问用户区与内核区。
    - 进程的分区就是以操作系统的分区为前提的
- linux系统如何分区
  - linux是面向进程设计的操作系统，一切都要靠进程来运行。需关注进程分区如何实现
  - 进程依靠指针寻址。
    - 32位系统中一个进程就是4g byte（2的32次方byte），一个32位的指针（指针的位数等于系统的位数，32位系统就是32位的指针）刚好可以寻址。
    - 因为指针只有32位或64位。所以一个进程只能有“2的32次方或64次方大小”，否则无法寻址了
    - 堆内存的本质是：在需要时申请的物理内存，申请到指针无法寻址为止，也就是达到一个进程的上限。
  - 由于指针的值可以修改，从软件的角度无法将用户区，内核区进行划分
  - 操作系统就通过CPU来实现分区
    - CPU有0，1，2，3级4种运行级别，linux和windows都只使用了0级或3级。当进程在用户区时，CPU在3的运行级别下运行，此时指针只能访问用户区。进程切换到内核区时，CPU的运行级别就切换到0级了，指针可以访问用户区和内核区

## linux内核区
![Alt text](image-1.png)
- linux系统内核区可以分为三部分
  - 下层
    - 驱动程序：直接将硬件抽象为一个个文件，方便上层操作
  - 中层 -- 操作系统真正的核心
    - 文件系统：对屏幕输出也是在对文件进行操作
    - 内存管理系统：我们经常需要对堆内存进行申请，释放操作
    - 进程管理系统：linux系统以进程为最小执行单元，而进程需要资源
    - 网络服务模块
  - 上层
    - 系统调用接口：用户区通过调用系统调用接口来间接操作内核区
- 进程内核区的对象为何一定要手动释放
  - 栈内存：函数执行完毕，栈内存自动回收，无需自己考虑。
  - 堆内存：动态申请的内存不会自动释放。栈内存是堆内存寻址的唯一方式，可以给堆内存添加一个引用计数，如果引用计数为0，那么就销毁堆内存（智能指针的工作原理）
  - 内核区：没有办法可以自行判断释放时机，任何语言都只能自己手动释放

## linux用户区
- C语言函数库
  - 系统调用接口提供的功能单一，使用麻烦
  - c语言函数库基于系统调用，使用方便，效率高，并且进行了大幅度的优化。
- shell
  - 用户通过shell来与操作系统交互
  - 提供各种命令和重定向等功能
  - 最常使用的一种shell是bash

## 终端
- 早期unix系统用一台电传打字机作为终端，当时终端还不属于操作系统
- 现在的操作系统会模拟出一个终端，通过该终端与shell交互，虚拟终端是操作系统的一部分
  - 虚拟终端如：图形界面、命令行终端
- linux的终端（“*”代表任何一个数字）
  - tty/*：linux默认提供的终端，是linux系统自带的黑窗口（ctrl+alt+f2~f8）
  - pts/*：虚拟终端。远程链接和图形界面都是虚拟终端。（ctrl+alt+t）

